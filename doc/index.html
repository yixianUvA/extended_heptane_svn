+<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta content="text/html; charset=iso-8859-1" http-equiv="content-type">    <title>Heptane: Main Page</title>    <link href="doxygen.css" rel="stylesheet" type="text/css">    <link href="tabs.css" rel="stylesheet" type="text/css">  </head>  <body>    <h1>Heptane Documentation</h1>    <h2 align="left">Quick links</h2>    <h3 align="left">User documentation</h3>    <ul>      <li><a href="#Installing">Compiling and installing</a></li>      <li><a href="#Running">Running</a></li>      <li><a href="#XML">Analysis XML format</a></li>      <li><a href="#Doxygen">Doxygen embedded documentation</a></li>    </ul>    <h3>Developer documentation</h3>    <ul>      <li><a href="#Hierarchy">Hierarchy of sources</a></li>      <li><a href="#Using">Calling existing analysis steps</a></li>      <li><a href="#Adding">Adding a new analysis method/analysis step</a></li>      <li><a href="#Doxygen">Doxygen embedded documentation</a></li>      <li><a href="#Unmaintained">Unmaintained code</a></li>    </ul>    <hr size="1">    <h2><a name="Installing"></a>Compiling and installing</h2>    <p align="justify">To be executed, Heptane needs the following software,      that will NOT be installed by the Heptane's installation software:</p>    <ul>      <li><strong>Integer Linear Programming (ILP) solver</strong>. Heptane may        use <a href="https://sourceforge.net/projects/lpsolve/">lp_solve</a>        (free) or CPLEX (commercial). The binary of one of these         two solvers has to be installed and be accessible in your PATH (the        binaries should be named lp_solve and cplex)<strong></strong></li>      <li><strong><a href="http://www.graphviz.org/">graphviz</a>        (optional)</strong>. Used to display CFGs. dot has to be        installed and be accessible from your PATH</li>       <li><strong><a href="http://www.doxygen.org/">doxygen</a>	(optional)</strong>. In case you want documentation to be	generated from the Heptane source code</li>     </ul>    <p align="justify">The following other software are also required, but will      be installed (if asked for) by the Heptane's installation script:</p>    <ul>      <li><strong>CFG (control flow graph) management library <em>cfglib</em></strong>.        This library is heavily used by Heptane to manipulate the program CFGs.        <strong><br>        </strong></li>      <li><strong>Cross-compilation toolchain.</strong> Heptane supports the        mips and arm ISA (the powerPC is not supported anymore). The Mips        cross-compiler toolchain (compiler, binutils) will be installed if asked        for during the Heptane's installation script.</li>    </ul>    <p align="justify"></p>    <h3 align="justify">Installation script (for new users, recommended)</h3>    <ul>      <li>The installation script install.sh is located at the root of the        Heptane's archive. </li>      <li>Before running it, first set up the installation parameters to specify        what you want to compile and installed</li>      <ul>        <li>CROSS_COMPILER_MIPS_INSTALL=1 : install a Mips cross-compiler toolchain</li>        <li>CROSS_COMPILER_ARM_INSTALL=1 : install a Arm cross-compiler toolchain</li>        <li>HEPTANE_CFGLIB_INSTALL=1 : install the CFG manipulation library</li>        <li>HEPTANE_CORE_INSTALL=1 : install Heptane itself</li>        <li>SCRIPT_CONFIG_INSTALL=1 : install the Heptane's xml configuration          files used by the HeptaneExtractor and HeptaneAnalysis with correct          links to cross-compiler toolchain</li>      </ul>     <!-- <li>In case you wish to install Mips compiler toolchain, set up variable        CROSS_DESTDIR to the places where you want to install them</li> -->      <li>Run the installation script</li>      <li>The Heptane binaries will be installed in directory bin</li>    </ul>    <h3 align="justify">Manual installation (for experienced users)</h3>    <ul>      <li><strong>CFG (control flow graph) management library <em>cfglib</em></strong>.        This library is heavily used by Heptane to manipulate the program CFGs.        <ul>          <li>Finding cfglib: the source code is in directory cfglib</li>          <li>Compiling cfglib            <ul>              <li>In GNUmakefile, set DESTDIR to the place where the library                should be installed</li>              <li>make</li>              <li>make install</li>            </ul>          </li>          <li>Cfglib heavily uses the libxml2 library, that has to be installed            before using Heptane</li>        </ul>      </li>      <li><strong>Cross-compilation toolchain.</strong> Heptane supports the        mips and powerPC ISA. A cross-compiler toolchain (compiler, binutils)        should be installed</li>     <!-- <ul>	<li>Instructions for building a MIPS cross compiler can be	  found <a href="xgcc.html">here</a></li>       </ul>  -->      <li><span style="font-weight: bold;">Cfglib. </span>CFG manipulation        library</li>      <ul>        <li>Go to src/cfglib</li>        <li>make; make install</li>      </ul>      <li><span style="font-weight: bold;">Heptane</span>. HeptaneExtractor and        HeptaneAnalysis</li>      <ul>        <li>cd src</li>        <li>Build a makefile.common file as follows:</li>        <ul>          <li>CONFIG=LINUX/MACOS to select your host operating system</li>          <li>TARGET=MIPS/PPC to select your target architecture</li>          <li>ADDR2LINE=bsolute path of the addr2line binary (addr2line is a            binary included in the binutils to retrieve information on line            numbers in source code on binaries compiled with the -ggdb option).            addr2line is useful by one analysis (the one showing the frequency            of code lines on th WCEP at the source code level). Installation of            addr2line is not useful if you do not use this analysis step. </li>          <li>end of makefile.common: can be found in directory            template/makefile.common.template</li>        </ul>        <li>Type make. Automatically installs the binaries into directory bin</li>      </ul>    </ul>    <hr size="1">    <h2><a name="Running"></a>Running</h2>    <h3><img src="Workflow.jpg" height="372" width="962"></h3>    <h3>Running the HeptaneExtractor</h3>    <ul>      <li><em>HeptaneExtract configExtract.xml</em>. An example of shell script        to generate CFGs is available in src/templates/extract.sh.template</li>      <li><em>configExtract.xml </em>is the HeptaneExtractor configuration file        allowing to configure the tool (location of cross-compiler toolchain,        selection of CFG extraction output). An example of xml file used by the        Heptane extractor is available in directory        src/templates/configExtract.xml.template. Shell script install.sh, from        this template, generates a ready to use configuration file in directory        config_files.</li>      <li>Ready to use programs are available in directory benchmarks/BENCH,        with BENCH a set of subdirectories containing the program source codes        and CFGs in xml format</li>      <li>The HeptaneExtractor generates an xml file containing the CFG of all        functions called by the program entry points, with attributes attached        to the CFGs, loops, basic blocks, etc. (loop bounds, addresses of        instructions mainly). The xml file is used by the WCET analysis steps. </li>    </ul>    <h3>Running the WCET estimation tool</h3>    <p>Command-line arcguments: <span style="font-style: italic;">HeptaneAnalysis</span>      <em>configfile.xml</em><em></em></p>    <ul>      <li><em>configfile.xml</em> is a configuration file in xml format (see <em></em><em>src/templates/configWCET.xml</em>.template        or an example). Shell script install.sh, from this template, generates a        ready to use configuration file in directory config_files.</li>      <li style="background-color: white;">An example of analyses called without        a configuration file is also given in file <em>HeptaneAnalysis/Analysis/main.cc.</em></li>    </ul>    <h3>Constraints on code structure</h3>    <h4>Use of function pointers</h4>    <p>Indirect calls, due to switch tables or use of pointers on functions are      not currently supported, because they do not allow the Cfg to be      constructed. Currently, the HeptaneExtractor just emits a warning when      encountering indirect calls. For indirect calls, the HeptaneExtractor      produces an empty Cfg as called function. Future extensions will allow at      least to annotate the possible points pointer targets. </p>    <h4>Calls to external functions (e.g. library code)</h4>    <p>When encountering a call to an Cfg contained in none of the analysed      files, the HeptaneExtractor tags the called Cfg as "External" and emits a      warning. An empty Cfg structure, whose name is the one of the called      function is created. In future extensions, there will be a way to attach      informations, such as the WCET of the called function, to the Cfg, using      annotations.</p>    <h4>Loop annotations</h4>    <p>Annotations serve at giving maximum number of iterations for loops. The      given values are constants. A loop maxiter specifies the maximum number of      iterations any basic block in the loop <em>body</em> executes. A loop      maxiter is <em>local</em> in the sense the number of iterations expresses      the maximum number of iterations in the context of the upper loop (if any)      or function (otherwise). There are two ways of providing loop bounds:</p>    <ul>      <li>In the C source code:<br>        <em>ANNOT_MAXITER(10);</em><br>      </li>      <li>In an external annotation file. The annotation file gives for every        CFG a description of the loop nesting and maxiters. Loops should apprear        in the same order than in the compiled code (this is checked by the WCET        estimation tool). Be careful to compiler optimizations that may change        the number / ordering of loops. An example of annotation file for the        fft benchmark is given in file <a href="fft.annot.xml">fft.annot.xml</a>.      </li>    </ul>    <hr size="1">    <h2><a name="XML" id="XML"></a>Analysis XML format</h2>    <h3>XML for control flow graph</h3>    <p>The DTD of the XML format used by analysis steps is available in this      directory (file <a href="cfglib.dtd"><em>cfglib.dtd</em></a>). The first      part of the file define the CFG format (program, cfg, node, loop, etc).      The second part of the file defines the XML format of non-built-in      attributes. </p>    <p>To check an existing XML against the DTD: type <em>xmllint --path        path_to_this_directory --valid name_of_file_to_be_checked &gt; /dev/null</em></p>    <p>The<em> <a href="cfglib.dtd"><em>cfglib.dtd</em></a> </em>file should      be modified when adding new non library supported attributes to the      library (see <a href="#Adding">Adding a new analysis method/step</a>      below).</p>    <h3>XML for annotation file</h3>    <p>The DTD of the XML format used for annotations (loop bounds) is available      in this directory (file <a href="annot.dtd"><em>annot.dtd</em></a>). An      example of annotation file is avaiable for the fft benchmark (<a href="fft.annot.xml">fft.annot.xml</a>).</p>    <hr size="1">    <h2><a name="Hierarchy" id="Hierarchy"></a>Hierarchy of sources</h2>    <ul>      <li>GNUMakefile and makefile.common. Used to configure, compile and        install the WCET analysis tool</li>      <li>HeptaneAnalysis: source code for WCET estimation tool        <ul>          <li>GNUmakefile: compilation of WCET estimation tool</li>          <li>GlobalAttributes: attributes shared between the HeptaneExtractor            and WCET analyzer</li>          <li>ArchitectureDependent: all architecture-dependent code for CFG            extraction and retrieval of information on instructions</li>          <li>Generic: analysis-independent code            <ul>              <li>Config.cc/h: reading of configuration file + execution from                the analyses steps given in configuration file</li>              <li>Analysis.cc/h: class defining the methods to be implemented to                achieve a WCET analysis step + usefuls methods for every                analysis</li>              <li>Logger.cc/f: class for managing warnings and errors inside                Heptane</li>              <li>CallGraph.cc/h: call graph manipulation</li>              <li> LoopTree.cc/h: loop nest manipulation</li>              <li>Timer.cc/h: management of timers</li>              <li>Context.cc/h: management of call contexts</li>            </ul>          </li>          <li>SharedAttributes: types and code of attributes shared between            analysis steps of WCETanalysis            <ul>              <li>SharedAttributes.h: naming conventions and interface of all                attributes</li>              <li>StackAddressAttribute.h: interface of StackAddressAttribute,                generated by the stack analyser</li>              <li>CodeLineAttributes.h: source code line information</li>            </ul>          </li>          <li>Specific: source code for analysis steps (see embedded            documentation for further details). Some analyses may not be listed            here. See the source code for an exhaustive list of analyses (one            directory per analysis)            <ul>              <li>CacheAnalysis: cache analyser</li>              <li>PipelineAnalysis: pipeline analysis</li>              <li>DataAddressAnalysis: data address and stack analyser (only for                MIPS target)</li>              <li>IPETAnalysis: WCET computation using ILP (lp_solve or CPLEX)</li>              <li>CodeLine: attachs code lines to basic blocks and instructions</li>              <li>HtmlPrint: prints the critical path at source code level</li>              <li>DotPrint: graphical printing of CFG using dot</li>              <li>SimplePrint: text printing of CFGs on standard output</li>            </ul>          </li>          <li>main.cc: user-provided C++ source file calling the different            analysis steps </li>        </ul>      </li>      <li>HeptaneExtract : source code for CFG extraction        <ul>          <li>ConfigExtract.cc/h: management of the extractor configuration file</li>          <li>Annotations.cc/h: management of annotations</li>          <li> dominatorAnalysis.cc/h: computation of domination information for            loop extraction</li>          <li>HeptaneExtract.cc: actual CFG construction</li>        </ul>      </li>      <li>bin: binary files</li>      <li>doc: documentation (html + doxygen-generated files)</li>      <li>TODO.txt: describes the current status of the analysis steps</li>    </ul>    <hr size="1">    <h2><a name="Using"></a>Calling existing analysis steps</h2>    <p>The normal usage of Heptane is to fill-in a configuration file that      contains architecture and analysis parameters. File Config.cc scans this      file and applies the analyses in the order specified by the file.</p>    <p>An alternative way of using Heptane (used mainly by Heptane developpers      when debugging the code) is to call analysis steps by program. Class      Analysis, from which all analyses are derived, implements the methods to      be called to apply one analysis. An example of call to the analysis steps      is provided in file main.cc. To call an analysis step, you have to :</p>    <ul>      <li>Create an object that implements the requested analysis pass (e.g.        IPETAnalysis). Parameters to the class constructor are step-specific and        init the analysis parameters</li>      <li>Call the main analysis method on the object</li>    </ul>    <address style="align: right;"> </address>    <hr size="1">    <h2><a name="Adding"></a>Adding a new analysis method/analysis step</h2>    <p>To add a new analysis:</p>    <ul>      <li>Create a new directory for the analysis in directory <em>Specific</em>,        with a directory name <em>MyNewAnalysis</em> as explicit as possible</li>      <li>Create a class inheriting from <em>Analysis</em>. Analysis defines        the main analysis steps (checking of serialisable input attributes,        analysis itself, removal of non serialisable attributes). All three        methods have to be implemented:        <ul>          <li>Checking the presence of serialisable input attributes is            mandatory. It allows to check as soon as possible that all analysis            inputs are available</li>          <li>The analysis method itself is unavoidable</li>          <li>The removal of internal non-serialisable attributes is very            important to reduce memory consumption and to avoid further analysis            steps to reuse the same attribute names.</li>        </ul>      </li>      <li>If the analysis produces a new attribute type, define the attribute        name and interface in file <em>Analysis/SharedAttributes/SharedAttributes.h</em>        (see the definition of the other attribute types as examples). To be        able to check the XML against the WCET analysis framework DTD, add a        description of yout attribute in file <a href="cfglib.dtd">cfglib.dtd</a>        (see <a href="#XML">Analysis XML format</a> above). If the attribute is        serializable, add it in the attribute factory (see        Analysis/Generic/WCETanalysis.cc)</li>      <li>Modify file <em>Analysis/main.cc</em> such that the newly introduced        analysis method/step is called.</li>      <li>Modify file <em>Analysis/Generic/Config.cc/h</em> to create a format        for the analysis parameters (for calls through the configuration file).<br>      </li>    </ul>    <hr size="1">    <h2><a name="Doxygen"></a>Doxygen embedded documentation</h2>    <ul>      <li>Comments embedded in source code and extracted using doxygen are        available.</li>    </ul>    <hr size="1">    <h2><a name="Unmaintained" id="Unmaintained"></a>Unmaintained code</h2>    <ul>      <li>Some analysis steps have been recently removed from the Heptane trunk        to keep the source code as small as possible. Among removed functions:        <ul>          <li>CRPD estimation</li>          <li>Analysis of single usage blocks (RTSS09) and cache bypass</li>          <li>Analysis of conflicts for multi-core analysis</li>        </ul>      </li>    </ul>    <p>&nbsp;</p>    <address style="align: right;"> </address>    <address style="align: right;"> </address>  </body></html>